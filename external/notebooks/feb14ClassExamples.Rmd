---
title: "feb14ClassExamples"
author: "Harrison Leduc"
date: "2024-02-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

In-class examples feb 14 slides.

Use a for to iterate over each row of dat and calculate it's sum

Do the same with lapply and sapply

Do the same using rowSums

Select rows from dat containing the letter "E" in V4, and take the mean of values from the result in column V3

```{r}
set.seed(50)
dat <- data.frame(
  V1 = 1:20,
  V2 = sample(1:100, 20, replace = TRUE),
  V3 = runif(20, 0, 50),
  V4 = sample(LETTERS[1:5], 20, replace = TRUE)
)

dat


for (i in 1:nrow(dat)) {
  o <- sum(dat[i, c("V1", "V2", "V3")])
  print(o)
}

# another approach to make the for loop more useful//similar to sapply -------------------
o1 <- NULL
for (i in 1:nrow(dat)) {
  o1[i] <- sum(dat[i, c("V1", "V2", "V3")])
}
o1

sapply(1:nrow(dat), function(x) {
  o <- sum(dat[x, c("V1", "V2", "V3")])
  return(o)
})


lapply(1:nrow(dat), function(x) {
  o <- sum(dat[x, c("V1", "V2", "V3")])
  return(o)
})

# another aproach for lapply -------------------
sum_lapply <- lapply(1:nrow(dat), function(x) {
  sum(dat[x, 1:3])
})
sum_lapply

# another aproach for sapply -------------------
# sapply provides a vector, lapply always gives a list (sapply gives smallest possible data type)
sum_sapply <- lapply(1:nrow(dat), function(x) {
  sum(dat[x, 1:3])
})
sum_sapply


rowSums(dat[, c("V1", "V2", "V3")])

# another approach for rowSums --------------------
rowSums(dat[, 1:3])
# more efficient!!! remember to use the numbers for columns when applicable!

# Extra demonstration in class 2/19
set.seed(50)
ind <- 1e5 #data frame with 10 million rows
dat1 <- data.frame(
  V1 = 1:ind,
  V2 = sample(1:100, ind, replace = TRUE),
  V3 = runif(ind, 0, 50)
)

dat1
nrow(dat1)

system.time(o <- sapply(1:ind, function(x) sum(dat1[x, ]))) #takes very long, 
                                                            # at least 60 seconds
system.time(o <- rowSums(dat1))

# Back to the exercises / homework -------------



mean(dat[which(dat[, "V4"] == "E"), "V3"])

# Another approach to get the mean based on E --------
library(dplyr)
dat2 <- dat %>% 
  filter(V4 == "E") %>% 
  summarize(mu = mean(V3))
dat2

# or using subset ------
b <- subset(dat, V4 == "E")
colMeans(b["V3"]) 
# or instead of colMeans use
mean(b$V3)

# doing pure base R -----
mean(dat[dat$V4 == "E", "V3"])
```


Unit 1 Module 3 questions:
Question: why shouldn’t you use the name “df” to name this object?
  •	df is very vague//lacks description and can be easily overwritten.
Question: why is it okay to rename a column in DF “c”, but not to rename v3 as c?
  •	The actual object, v3, should never be named c due to the function concatenate (combine) and how this could create issues with mirroring.
Look at the str of DF. What kind of data type is “grp”? How would you change it between character and factor and back again?
  •	Grp is a chr type (character). To change this to factor you could write
•	DF$grp <- as.factor(DF$grp)
•	To change it back:
  •	DF$grp <- as.character(DF$grp)


